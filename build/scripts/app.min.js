(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"./src/scripts/app.js":[function(require,module,exports){
// var angular = require('angular');
// var $ = require('jquery-browserify');
// var bootstrap = require('bootstrap');
// require('jquery-mousewheel')($);
// var jQuery = $;
// require('../../libs/scrollbar/jquery.mCustomScrollbar');
// require('../../libs/slick/slick.min');
require('./infscr');
require('./ads');
require('./scores');


(function($){


/// Sub Nav Area Functionality
var closer;


function SubNav(event){
	window.clearTimeout(closer);
	
	var target = $(event.target).attr('targ')

	// remove red from item and link
	$('#MainNav ul li').removeClass('selected');
	$('#MainNav ul li a').removeClass('selected');
	
	// add red background to hovered item
	$(event.target).addClass('selected');
	// hide all of the sub nav
	$('#SideSubNav ul').hide();
	// show the subnav for the hovered item
	$('#' + target + '-nav').css('display', 'block');

	// slide the main content over to the right
	$('#MainContent').css('left', '320px');
	BackgroundPosition(320);
}

// activate SubNav on mouseover or click of main nav
$("#MainNav").on("click mouseover", "ul li", SubNav);


function CloseSubNav (event) {
	var mainWidth = $('#MainContent').css('left');
	mainWidth = mainWidth.replace('px', '');
	mainWidth = parseInt(mainWidth);
	// if the nav bar is open close the sub nav
	if (mainWidth >= 175) {
		closer = window.setTimeout(function () {
			$('#MainContent').css('left', '175px');
			BackgroundPosition(175);
		}, 500);
	}
}


// if the mouse enters the main content close the subnav
$('main').on('mouseenter', CloseSubNav);


function ClickMenu(event) {
	if ($('#MainContent').css('left') == '30px') {
		$('#MainContent').css('left','175px');
		BackgroundPosition(175);
	} else {
		$('#MainContent').css('left','30px');
		BackgroundPosition(30);
	}
}

$('.shownav').on('click', ClickMenu);

function SideBar(){
	if($("#sidebar-ad-placeholder").height() < 250){
		ad_offset = 250
	} else {
		ad_offset = $("#sidebar-ad-placeholder").height();
	}
	var offset =  $(window).height() - ($('#HeaderContent').height() + ad_offset + 70);
	$("#SideBar").css({'margin-top': ($(window).scrollTop()), 'height': offset});
	$("#sidebar-ad-placeholder").css({'position': 'fixed', 'bottom': 10});
}

function HeaderHeight() {
	$('.header-push').css('padding-top', $('#HeaderContent').height() + 10);
}

function BackgroundPosition(mainmargin) {
	var mainwidth = $('#MainContent').width();
	var headercontent = $('#HeaderContent').height();
	var combinedwidth = mainmargin + parseInt(mainwidth);
	var combinedpos = combinedwidth + 'px ' + (headercontent + 10) + 'px'
	//console.log(combinedpos);
	$('body, html').css('background-position', combinedpos);
}

HeaderHeight();
SideBar();
BackgroundPosition($('#MainContent').position().left);

$(window).resize(function(event) {
	SideBar();
	HeaderHeight();
	BackgroundPosition($('#MainContent').position().left);
})

/**  Keep the sidebar up top **/
$(window).scroll(function(event){
$("#SideBar")
	.stop()
	SideBar();
});



/*******************************************************/


// ********* Init custom scrollbars here  ********* //
$("#MainNav").mCustomScrollbar({
    axis:"y", // vertical scrollbar
    theme:"minimal"
});

$("#SideSubNav").mCustomScrollbar({
    axis:"y", // vertical scrollbar
    theme:"minimal"
});

$(".TabPanel").mCustomScrollbar({
    axis:"y", // vertical scrollbar
    theme:"minimal-dark"
});

// *********** Tabs Functionality Init.  ************ //
$('#tabs a').click(function (e) {
  e.preventDefault()
  $(this).tab('show')
})

})(jQuery);

},{"./ads":"/home/rgordon/Desktop/Projects/gw_dev/src/scripts/ads.js","./infscr":"/home/rgordon/Desktop/Projects/gw_dev/src/scripts/infscr.js","./scores":"/home/rgordon/Desktop/Projects/gw_dev/src/scripts/scores.js"}],"/home/rgordon/Desktop/Projects/gw_dev/src/scripts/ads.js":[function(require,module,exports){
(function (googletag) {
// GPT slots
var gptAdSlots = [];
googletag.cmd.push(function() {

// Define a size mapping object. The first parameter to addSize is
// a viewport size, while the second is a list of allowed ad sizes.
var mapping728x90 = googletag.sizeMapping().

// Accepts both common mobile banner formats
addSize([0, 0], [[320, 50], [300, 50]]). 
// Small Devices and larger
addSize([768, 0], [728, 90]).
// Small Devices and larger
addSize([1020, 0], [[980, 50], [728, 90]]).build();

// Define the GPT slot
gptAdSlots[0] = googletag.defineSlot('/310322/a.site152.tmus', [980, 50], 'header-ad-placeholder').
defineSizeMapping(mapping728x90).
addService(googletag.pubads());


var mapping300x250 = googletag.sizeMapping().
// Accepts both common mobile banner formats
addSize([0, 0], [300, 250]). 
// Small Devices and larger
addSize([768, 850], [300, 250],[300, 600]).build();		

gptAdSlots[1] = googletag.defineSlot('/310322/a.site152.tmus', [300, 250], 'sidebar-ad-placeholder').
defineSizeMapping(mapping300x250).
addService(googletag.pubads());

// Start ad fetching
googletag.enableServices();
googletag.cmd.push(function() {
	googletag.display('header-ad-placeholder');
	googletag.display('sidebar-ad-placeholder');
});
});

// setInterval(function(){
// 	googletag.pubads().refresh();
// 	console.log("Refresh Ads");
// }, 15000);
})(googletag)
},{}],"/home/rgordon/Desktop/Projects/gw_dev/src/scripts/infscr.js":[function(require,module,exports){
(function (angular) {
var infscr = angular.module('infscr', []);

infscr.config(function ($httpProvider) {
	delete $httpProvider.defaults.headers.common['X-Requested-With'];
});


// scrollDiv defines the object to be used as a directive
function scrollDiv ($window) {
  'use strict';

  // this function loads on the defined element
  return function (scope, element, attrs) {
      // position starts at 0
      scope.position = 0;

      // wait for the LOADDONE event
      scope.$on('LOADDONE', function (event) {
        scope.position = Math.floor(((window.pageYOffset + $(window).height()) / $(document).height()) * 100);
        
        angular.element(window).bind('scroll', function () {          
          scope.position = Math.floor(((this.pageYOffset + $(window).height()) / $(document).height()) * 100);
          if (scope.position > 85) {
            scope.getMore();
          }
          scope.$apply();
        });

        if (scope.count >= 60) {
          angular.element(window).unbind('scroll');
        }
      });

    }
}

// assign scrollDiv to a directive
// in a minification safe manner
infscr.directive('scrollDiv', ['$window', scrollDiv]);






// The getStoryList function uses angularjs' $http
// object to make xhr's to get stories
function getStoryList ($http) {

  // the url to request stories from
  var url = 'http://golfweek.com/json/';

  return {
    // the get function should suffice for most normal uses
    // it accepts a context object to get info about the sections
    // ctx also needs a success function to return the data
    get: function (ctx) {
      // the category function is here for future use with sections and sub sections
      // currently it is not used
      var category = (ctx.section === undefined) ? '' : ctx.section;
      category += (ctx.sub === undefined || ctx.sub === 'all') ? '' : '/' + ctx.sub;
      category += (ctx.subsub === undefined) ? '' : '/' + ctx.subsub;
      category += (ctx.subsubsub === undefined) ? '' : '/' + ctx.subsubsub;
      
      // the count is at minimum 15 but must be in increments of 15 currently
      var count = (ctx.count === undefined) ? 15 : ctx.count;
      
      // make the request to golfweek 
      // ***MUST BE A POST OR ELLINGTON BLOCKS IT***
      $http.post(url + 'section/?Section=' + category + '&Num=' + count)
        .success(function (data) {  
          ctx.success(data);
        })
        .error(function (data, status) {
          console.log(data, status);
        });
    }
  }
}


// Assign getStoryList as an angular factory 
// in a manner safe for minification
infscr.factory('getStoryList', ['$http', getStoryList]);



// the getStoryContent function is intended to load the clicked
// story into the selected div
function getStoryContent ($http) {
  
  // the base url to request the storydata from
  var url = 'http://golfweek.com/';

  return {
    get: function (ctx) {      
      $http.post(url + ctx.slug + '?json')
        .success(function (data) {
          ctx.storySuccess(data);
        })
        .error(function (data, status) {
          console.log(data, status);
        });
    }
  }
}


// Assign getStoryList as an angular factory 
// in a manner safe for minification
infscr.factory('getStoryContent', ['$http', getStoryContent]);



// the infScrollController function is intended to be used 
// in the div where the stories should be added for infinite 
// scrolling
function infScrollController ($scope, $window, storyList, story) {
	$scope.count = 15;  // number of stories to get
	$scope.fetching = false; // are we fetching right now?
  $scope.stories = []; // starts out as an empty array

  $scope.$on('LOAD', function (e) { $scope.fetching = true; });
  $scope.$on('LOADDONE', function (e) { $scope.fetching = false; });

  // this is the success handler when data is received
  $scope.success = function (data) {
    angular.forEach(data.stories, function (val, key) {
      this[key] = val;
    }, $scope.stories);
    // console.log('%O', $scope.stories[0]);
    // let everything know we are done loading
    $scope.$emit('LOADDONE');
  }

  // get the stories the first time
  storyList.get($scope);

  // getMore should be used when the div is scrolled
	$scope.getMore = function () {
		// if page position is bigger than 88 
		// fetch more stories
		if (!$scope.fetching) {
      $scope.$emit('LOAD');
      $scope.count = ($scope.count === 60) ? 60 : $scope.count + 15;
			// let everything know we are loading
      storyList.get($scope);

		}
	}

  $scope.storySuccess = function (data) {
    // set the data here to the expanding div for the story
    // console.log('%o', $scope.stories);
    $scope.stories[$scope.storyId]['storyContent'] = data.story[0];
    console.log(data);
  }


  $scope.storyClick = function () {
    // console.log('%o',this.$index)
    $scope.slug = this.story.id;
    $scope.storyId = this.$index;
    story.get($scope);
  }


}


// Assign infScrollController as an angular controller 
// in a manner safe for minification
infscr.controller('infScrollCtrl', ['$scope', '$window', 'getStoryList', 'getStoryContent', infScrollController]);






(function () {

  var THECODE = [38,38,40,40,37,39,37,39,66,65];

  var testcode = [];
  var time;

  // k code stuff
  function checkKeys (e) {
    var button = (e.keyCode);

    if (THECODE.indexOf(button) > -1) {
      testcode[testcode.length] = e.keyCode;

      if (testcode.length === THECODE.length) {
        checkCode();
      } else {
        clearCode();
      }
    }
  }

  function checkCode () {
    for (var i = 0; i < THECODE.length; i++) {
      if (THECODE[i] !== testcode[i]) {
        testcode = [];
        break;
      }
    }
    if (testcode.length > 0) {
      console.log('duf time!');
    }
  }

  function clearCode () {
    if (time === undefined) {
      time = window.setTimeout(function() {
        testcode = [];
        window.clearTimeout(time);
      }, 10000);
    }
  }


  window.addEventListener('keydown', checkKeys);
})()


})(angular);
},{}],"/home/rgordon/Desktop/Projects/gw_dev/src/scripts/scores.js":[function(require,module,exports){
(function (angular, $) {
	
	// this is the live scoring app for the widget on the top right
	// live scoring will match as closely as possible the output from the
	// element with the id "framing"
	// different behaviour will likely need to be put in place for the 
	// home page version
	// ***NOTE nwid (nationwide) is now known as web.com tour ***
	// pga / nwid / chmp scoring will come from xml documents on rankings.golfweek.com
	// college / amateur / junior scoring will come from golfstat


	// PGA model

	// pga data should be the xml data 
	function PGA (pgadata) {
		if (pgadata) {
			this.setData(pgadata);
		}
		// other standard initializations
	}

	PGA.prototype = {
		setData: function (pgadata) {
			angular.extend(this, pgadata);
		},
		// Load will fetch the data from the pga xml
		load: function () {
			var scope = this;
			scope.players = [];
			$.ajax({
				type: "GET",
				url:'http://rankings.golfweek.com/fetchurl/assets/pga.xml',
				dataType: 'xml'
				}).success(function (pgadata) {
				scope.setData(pgadata);
				var players = $(pgadata).find('Player');
				for (var i = players.length - 1; i >= 0; i--) {
					player = {};
					player.name = $(players[i]).attr('FInit') + ". " + $(players[i]).attr('Lname');
					player.current_rank = $(players[i]).attr('CurPos');
					player.today = $(players[i]).attr('CurParRel');
					player.overall = $(players[i]).attr('TournParRel');
					player.thru = $(players[i]).attr('Thru');			
					scope.players.push(player);
				};
			});
		}
	}

	
	var thed = new PGA();
	thed.load();
	console.log(thed);

})(angular, jQuery);
},{}]},{},["./src/scripts/app.js"])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIuL3NyYy9zY3JpcHRzL2FwcC5qcyIsIi9ob21lL3Jnb3Jkb24vRGVza3RvcC9Qcm9qZWN0cy9nd19kZXYvc3JjL3NjcmlwdHMvYWRzLmpzIiwiL2hvbWUvcmdvcmRvbi9EZXNrdG9wL1Byb2plY3RzL2d3X2Rldi9zcmMvc2NyaXB0cy9pbmZzY3IuanMiLCIvaG9tZS9yZ29yZG9uL0Rlc2t0b3AvUHJvamVjdHMvZ3dfZGV2L3NyYy9zY3JpcHRzL3Njb3Jlcy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvLyB2YXIgYW5ndWxhciA9IHJlcXVpcmUoJ2FuZ3VsYXInKTtcbi8vIHZhciAkID0gcmVxdWlyZSgnanF1ZXJ5LWJyb3dzZXJpZnknKTtcbi8vIHZhciBib290c3RyYXAgPSByZXF1aXJlKCdib290c3RyYXAnKTtcbi8vIHJlcXVpcmUoJ2pxdWVyeS1tb3VzZXdoZWVsJykoJCk7XG4vLyB2YXIgalF1ZXJ5ID0gJDtcbi8vIHJlcXVpcmUoJy4uLy4uL2xpYnMvc2Nyb2xsYmFyL2pxdWVyeS5tQ3VzdG9tU2Nyb2xsYmFyJyk7XG4vLyByZXF1aXJlKCcuLi8uLi9saWJzL3NsaWNrL3NsaWNrLm1pbicpO1xucmVxdWlyZSgnLi9pbmZzY3InKTtcbnJlcXVpcmUoJy4vYWRzJyk7XG5yZXF1aXJlKCcuL3Njb3JlcycpO1xuXG5cbihmdW5jdGlvbigkKXtcblxuXG4vLy8gU3ViIE5hdiBBcmVhIEZ1bmN0aW9uYWxpdHlcbnZhciBjbG9zZXI7XG5cblxuZnVuY3Rpb24gU3ViTmF2KGV2ZW50KXtcblx0d2luZG93LmNsZWFyVGltZW91dChjbG9zZXIpO1xuXHRcblx0dmFyIHRhcmdldCA9ICQoZXZlbnQudGFyZ2V0KS5hdHRyKCd0YXJnJylcblxuXHQvLyByZW1vdmUgcmVkIGZyb20gaXRlbSBhbmQgbGlua1xuXHQkKCcjTWFpbk5hdiB1bCBsaScpLnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuXHQkKCcjTWFpbk5hdiB1bCBsaSBhJykucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG5cdFxuXHQvLyBhZGQgcmVkIGJhY2tncm91bmQgdG8gaG92ZXJlZCBpdGVtXG5cdCQoZXZlbnQudGFyZ2V0KS5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcblx0Ly8gaGlkZSBhbGwgb2YgdGhlIHN1YiBuYXZcblx0JCgnI1NpZGVTdWJOYXYgdWwnKS5oaWRlKCk7XG5cdC8vIHNob3cgdGhlIHN1Ym5hdiBmb3IgdGhlIGhvdmVyZWQgaXRlbVxuXHQkKCcjJyArIHRhcmdldCArICctbmF2JykuY3NzKCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG5cblx0Ly8gc2xpZGUgdGhlIG1haW4gY29udGVudCBvdmVyIHRvIHRoZSByaWdodFxuXHQkKCcjTWFpbkNvbnRlbnQnKS5jc3MoJ2xlZnQnLCAnMzIwcHgnKTtcblx0QmFja2dyb3VuZFBvc2l0aW9uKDMyMCk7XG59XG5cbi8vIGFjdGl2YXRlIFN1Yk5hdiBvbiBtb3VzZW92ZXIgb3IgY2xpY2sgb2YgbWFpbiBuYXZcbiQoXCIjTWFpbk5hdlwiKS5vbihcImNsaWNrIG1vdXNlb3ZlclwiLCBcInVsIGxpXCIsIFN1Yk5hdik7XG5cblxuZnVuY3Rpb24gQ2xvc2VTdWJOYXYgKGV2ZW50KSB7XG5cdHZhciBtYWluV2lkdGggPSAkKCcjTWFpbkNvbnRlbnQnKS5jc3MoJ2xlZnQnKTtcblx0bWFpbldpZHRoID0gbWFpbldpZHRoLnJlcGxhY2UoJ3B4JywgJycpO1xuXHRtYWluV2lkdGggPSBwYXJzZUludChtYWluV2lkdGgpO1xuXHQvLyBpZiB0aGUgbmF2IGJhciBpcyBvcGVuIGNsb3NlIHRoZSBzdWIgbmF2XG5cdGlmIChtYWluV2lkdGggPj0gMTc1KSB7XG5cdFx0Y2xvc2VyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXHRcdFx0JCgnI01haW5Db250ZW50JykuY3NzKCdsZWZ0JywgJzE3NXB4Jyk7XG5cdFx0XHRCYWNrZ3JvdW5kUG9zaXRpb24oMTc1KTtcblx0XHR9LCA1MDApO1xuXHR9XG59XG5cblxuLy8gaWYgdGhlIG1vdXNlIGVudGVycyB0aGUgbWFpbiBjb250ZW50IGNsb3NlIHRoZSBzdWJuYXZcbiQoJ21haW4nKS5vbignbW91c2VlbnRlcicsIENsb3NlU3ViTmF2KTtcblxuXG5mdW5jdGlvbiBDbGlja01lbnUoZXZlbnQpIHtcblx0aWYgKCQoJyNNYWluQ29udGVudCcpLmNzcygnbGVmdCcpID09ICczMHB4Jykge1xuXHRcdCQoJyNNYWluQ29udGVudCcpLmNzcygnbGVmdCcsJzE3NXB4Jyk7XG5cdFx0QmFja2dyb3VuZFBvc2l0aW9uKDE3NSk7XG5cdH0gZWxzZSB7XG5cdFx0JCgnI01haW5Db250ZW50JykuY3NzKCdsZWZ0JywnMzBweCcpO1xuXHRcdEJhY2tncm91bmRQb3NpdGlvbigzMCk7XG5cdH1cbn1cblxuJCgnLnNob3duYXYnKS5vbignY2xpY2snLCBDbGlja01lbnUpO1xuXG5mdW5jdGlvbiBTaWRlQmFyKCl7XG5cdGlmKCQoXCIjc2lkZWJhci1hZC1wbGFjZWhvbGRlclwiKS5oZWlnaHQoKSA8IDI1MCl7XG5cdFx0YWRfb2Zmc2V0ID0gMjUwXG5cdH0gZWxzZSB7XG5cdFx0YWRfb2Zmc2V0ID0gJChcIiNzaWRlYmFyLWFkLXBsYWNlaG9sZGVyXCIpLmhlaWdodCgpO1xuXHR9XG5cdHZhciBvZmZzZXQgPSAgJCh3aW5kb3cpLmhlaWdodCgpIC0gKCQoJyNIZWFkZXJDb250ZW50JykuaGVpZ2h0KCkgKyBhZF9vZmZzZXQgKyA3MCk7XG5cdCQoXCIjU2lkZUJhclwiKS5jc3MoeydtYXJnaW4tdG9wJzogKCQod2luZG93KS5zY3JvbGxUb3AoKSksICdoZWlnaHQnOiBvZmZzZXR9KTtcblx0JChcIiNzaWRlYmFyLWFkLXBsYWNlaG9sZGVyXCIpLmNzcyh7J3Bvc2l0aW9uJzogJ2ZpeGVkJywgJ2JvdHRvbSc6IDEwfSk7XG59XG5cbmZ1bmN0aW9uIEhlYWRlckhlaWdodCgpIHtcblx0JCgnLmhlYWRlci1wdXNoJykuY3NzKCdwYWRkaW5nLXRvcCcsICQoJyNIZWFkZXJDb250ZW50JykuaGVpZ2h0KCkgKyAxMCk7XG59XG5cbmZ1bmN0aW9uIEJhY2tncm91bmRQb3NpdGlvbihtYWlubWFyZ2luKSB7XG5cdHZhciBtYWlud2lkdGggPSAkKCcjTWFpbkNvbnRlbnQnKS53aWR0aCgpO1xuXHR2YXIgaGVhZGVyY29udGVudCA9ICQoJyNIZWFkZXJDb250ZW50JykuaGVpZ2h0KCk7XG5cdHZhciBjb21iaW5lZHdpZHRoID0gbWFpbm1hcmdpbiArIHBhcnNlSW50KG1haW53aWR0aCk7XG5cdHZhciBjb21iaW5lZHBvcyA9IGNvbWJpbmVkd2lkdGggKyAncHggJyArIChoZWFkZXJjb250ZW50ICsgMTApICsgJ3B4J1xuXHQvL2NvbnNvbGUubG9nKGNvbWJpbmVkcG9zKTtcblx0JCgnYm9keSwgaHRtbCcpLmNzcygnYmFja2dyb3VuZC1wb3NpdGlvbicsIGNvbWJpbmVkcG9zKTtcbn1cblxuSGVhZGVySGVpZ2h0KCk7XG5TaWRlQmFyKCk7XG5CYWNrZ3JvdW5kUG9zaXRpb24oJCgnI01haW5Db250ZW50JykucG9zaXRpb24oKS5sZWZ0KTtcblxuJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbihldmVudCkge1xuXHRTaWRlQmFyKCk7XG5cdEhlYWRlckhlaWdodCgpO1xuXHRCYWNrZ3JvdW5kUG9zaXRpb24oJCgnI01haW5Db250ZW50JykucG9zaXRpb24oKS5sZWZ0KTtcbn0pXG5cbi8qKiAgS2VlcCB0aGUgc2lkZWJhciB1cCB0b3AgKiovXG4kKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKGV2ZW50KXtcbiQoXCIjU2lkZUJhclwiKVxuXHQuc3RvcCgpXG5cdFNpZGVCYXIoKTtcbn0pO1xuXG5cblxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovXG5cblxuLy8gKioqKioqKioqIEluaXQgY3VzdG9tIHNjcm9sbGJhcnMgaGVyZSAgKioqKioqKioqIC8vXG4kKFwiI01haW5OYXZcIikubUN1c3RvbVNjcm9sbGJhcih7XG4gICAgYXhpczpcInlcIiwgLy8gdmVydGljYWwgc2Nyb2xsYmFyXG4gICAgdGhlbWU6XCJtaW5pbWFsXCJcbn0pO1xuXG4kKFwiI1NpZGVTdWJOYXZcIikubUN1c3RvbVNjcm9sbGJhcih7XG4gICAgYXhpczpcInlcIiwgLy8gdmVydGljYWwgc2Nyb2xsYmFyXG4gICAgdGhlbWU6XCJtaW5pbWFsXCJcbn0pO1xuXG4kKFwiLlRhYlBhbmVsXCIpLm1DdXN0b21TY3JvbGxiYXIoe1xuICAgIGF4aXM6XCJ5XCIsIC8vIHZlcnRpY2FsIHNjcm9sbGJhclxuICAgIHRoZW1lOlwibWluaW1hbC1kYXJrXCJcbn0pO1xuXG4vLyAqKioqKioqKioqKiBUYWJzIEZ1bmN0aW9uYWxpdHkgSW5pdC4gICoqKioqKioqKioqKiAvL1xuJCgnI3RhYnMgYScpLmNsaWNrKGZ1bmN0aW9uIChlKSB7XG4gIGUucHJldmVudERlZmF1bHQoKVxuICAkKHRoaXMpLnRhYignc2hvdycpXG59KVxuXG59KShqUXVlcnkpO1xuIiwiKGZ1bmN0aW9uIChnb29nbGV0YWcpIHtcbi8vIEdQVCBzbG90c1xudmFyIGdwdEFkU2xvdHMgPSBbXTtcbmdvb2dsZXRhZy5jbWQucHVzaChmdW5jdGlvbigpIHtcblxuLy8gRGVmaW5lIGEgc2l6ZSBtYXBwaW5nIG9iamVjdC4gVGhlIGZpcnN0IHBhcmFtZXRlciB0byBhZGRTaXplIGlzXG4vLyBhIHZpZXdwb3J0IHNpemUsIHdoaWxlIHRoZSBzZWNvbmQgaXMgYSBsaXN0IG9mIGFsbG93ZWQgYWQgc2l6ZXMuXG52YXIgbWFwcGluZzcyOHg5MCA9IGdvb2dsZXRhZy5zaXplTWFwcGluZygpLlxuXG4vLyBBY2NlcHRzIGJvdGggY29tbW9uIG1vYmlsZSBiYW5uZXIgZm9ybWF0c1xuYWRkU2l6ZShbMCwgMF0sIFtbMzIwLCA1MF0sIFszMDAsIDUwXV0pLiBcbi8vIFNtYWxsIERldmljZXMgYW5kIGxhcmdlclxuYWRkU2l6ZShbNzY4LCAwXSwgWzcyOCwgOTBdKS5cbi8vIFNtYWxsIERldmljZXMgYW5kIGxhcmdlclxuYWRkU2l6ZShbMTAyMCwgMF0sIFtbOTgwLCA1MF0sIFs3MjgsIDkwXV0pLmJ1aWxkKCk7XG5cbi8vIERlZmluZSB0aGUgR1BUIHNsb3RcbmdwdEFkU2xvdHNbMF0gPSBnb29nbGV0YWcuZGVmaW5lU2xvdCgnLzMxMDMyMi9hLnNpdGUxNTIudG11cycsIFs5ODAsIDUwXSwgJ2hlYWRlci1hZC1wbGFjZWhvbGRlcicpLlxuZGVmaW5lU2l6ZU1hcHBpbmcobWFwcGluZzcyOHg5MCkuXG5hZGRTZXJ2aWNlKGdvb2dsZXRhZy5wdWJhZHMoKSk7XG5cblxudmFyIG1hcHBpbmczMDB4MjUwID0gZ29vZ2xldGFnLnNpemVNYXBwaW5nKCkuXG4vLyBBY2NlcHRzIGJvdGggY29tbW9uIG1vYmlsZSBiYW5uZXIgZm9ybWF0c1xuYWRkU2l6ZShbMCwgMF0sIFszMDAsIDI1MF0pLiBcbi8vIFNtYWxsIERldmljZXMgYW5kIGxhcmdlclxuYWRkU2l6ZShbNzY4LCA4NTBdLCBbMzAwLCAyNTBdLFszMDAsIDYwMF0pLmJ1aWxkKCk7XHRcdFxuXG5ncHRBZFNsb3RzWzFdID0gZ29vZ2xldGFnLmRlZmluZVNsb3QoJy8zMTAzMjIvYS5zaXRlMTUyLnRtdXMnLCBbMzAwLCAyNTBdLCAnc2lkZWJhci1hZC1wbGFjZWhvbGRlcicpLlxuZGVmaW5lU2l6ZU1hcHBpbmcobWFwcGluZzMwMHgyNTApLlxuYWRkU2VydmljZShnb29nbGV0YWcucHViYWRzKCkpO1xuXG4vLyBTdGFydCBhZCBmZXRjaGluZ1xuZ29vZ2xldGFnLmVuYWJsZVNlcnZpY2VzKCk7XG5nb29nbGV0YWcuY21kLnB1c2goZnVuY3Rpb24oKSB7XG5cdGdvb2dsZXRhZy5kaXNwbGF5KCdoZWFkZXItYWQtcGxhY2Vob2xkZXInKTtcblx0Z29vZ2xldGFnLmRpc3BsYXkoJ3NpZGViYXItYWQtcGxhY2Vob2xkZXInKTtcbn0pO1xufSk7XG5cbi8vIHNldEludGVydmFsKGZ1bmN0aW9uKCl7XG4vLyBcdGdvb2dsZXRhZy5wdWJhZHMoKS5yZWZyZXNoKCk7XG4vLyBcdGNvbnNvbGUubG9nKFwiUmVmcmVzaCBBZHNcIik7XG4vLyB9LCAxNTAwMCk7XG59KShnb29nbGV0YWcpIiwiKGZ1bmN0aW9uIChhbmd1bGFyKSB7XG52YXIgaW5mc2NyID0gYW5ndWxhci5tb2R1bGUoJ2luZnNjcicsIFtdKTtcblxuaW5mc2NyLmNvbmZpZyhmdW5jdGlvbiAoJGh0dHBQcm92aWRlcikge1xuXHRkZWxldGUgJGh0dHBQcm92aWRlci5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1SZXF1ZXN0ZWQtV2l0aCddO1xufSk7XG5cblxuLy8gc2Nyb2xsRGl2IGRlZmluZXMgdGhlIG9iamVjdCB0byBiZSB1c2VkIGFzIGEgZGlyZWN0aXZlXG5mdW5jdGlvbiBzY3JvbGxEaXYgKCR3aW5kb3cpIHtcbiAgJ3VzZSBzdHJpY3QnO1xuXG4gIC8vIHRoaXMgZnVuY3Rpb24gbG9hZHMgb24gdGhlIGRlZmluZWQgZWxlbWVudFxuICByZXR1cm4gZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgLy8gcG9zaXRpb24gc3RhcnRzIGF0IDBcbiAgICAgIHNjb3BlLnBvc2l0aW9uID0gMDtcblxuICAgICAgLy8gd2FpdCBmb3IgdGhlIExPQURET05FIGV2ZW50XG4gICAgICBzY29wZS4kb24oJ0xPQURET05FJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgIHNjb3BlLnBvc2l0aW9uID0gTWF0aC5mbG9vcigoKHdpbmRvdy5wYWdlWU9mZnNldCArICQod2luZG93KS5oZWlnaHQoKSkgLyAkKGRvY3VtZW50KS5oZWlnaHQoKSkgKiAxMDApO1xuICAgICAgICBcbiAgICAgICAgYW5ndWxhci5lbGVtZW50KHdpbmRvdykuYmluZCgnc2Nyb2xsJywgZnVuY3Rpb24gKCkgeyAgICAgICAgICBcbiAgICAgICAgICBzY29wZS5wb3NpdGlvbiA9IE1hdGguZmxvb3IoKCh0aGlzLnBhZ2VZT2Zmc2V0ICsgJCh3aW5kb3cpLmhlaWdodCgpKSAvICQoZG9jdW1lbnQpLmhlaWdodCgpKSAqIDEwMCk7XG4gICAgICAgICAgaWYgKHNjb3BlLnBvc2l0aW9uID4gODUpIHtcbiAgICAgICAgICAgIHNjb3BlLmdldE1vcmUoKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmIChzY29wZS5jb3VudCA+PSA2MCkge1xuICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCh3aW5kb3cpLnVuYmluZCgnc2Nyb2xsJyk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgfVxufVxuXG4vLyBhc3NpZ24gc2Nyb2xsRGl2IHRvIGEgZGlyZWN0aXZlXG4vLyBpbiBhIG1pbmlmaWNhdGlvbiBzYWZlIG1hbm5lclxuaW5mc2NyLmRpcmVjdGl2ZSgnc2Nyb2xsRGl2JywgWyckd2luZG93Jywgc2Nyb2xsRGl2XSk7XG5cblxuXG5cblxuXG4vLyBUaGUgZ2V0U3RvcnlMaXN0IGZ1bmN0aW9uIHVzZXMgYW5ndWxhcmpzJyAkaHR0cFxuLy8gb2JqZWN0IHRvIG1ha2UgeGhyJ3MgdG8gZ2V0IHN0b3JpZXNcbmZ1bmN0aW9uIGdldFN0b3J5TGlzdCAoJGh0dHApIHtcblxuICAvLyB0aGUgdXJsIHRvIHJlcXVlc3Qgc3RvcmllcyBmcm9tXG4gIHZhciB1cmwgPSAnaHR0cDovL2dvbGZ3ZWVrLmNvbS9qc29uLyc7XG5cbiAgcmV0dXJuIHtcbiAgICAvLyB0aGUgZ2V0IGZ1bmN0aW9uIHNob3VsZCBzdWZmaWNlIGZvciBtb3N0IG5vcm1hbCB1c2VzXG4gICAgLy8gaXQgYWNjZXB0cyBhIGNvbnRleHQgb2JqZWN0IHRvIGdldCBpbmZvIGFib3V0IHRoZSBzZWN0aW9uc1xuICAgIC8vIGN0eCBhbHNvIG5lZWRzIGEgc3VjY2VzcyBmdW5jdGlvbiB0byByZXR1cm4gdGhlIGRhdGFcbiAgICBnZXQ6IGZ1bmN0aW9uIChjdHgpIHtcbiAgICAgIC8vIHRoZSBjYXRlZ29yeSBmdW5jdGlvbiBpcyBoZXJlIGZvciBmdXR1cmUgdXNlIHdpdGggc2VjdGlvbnMgYW5kIHN1YiBzZWN0aW9uc1xuICAgICAgLy8gY3VycmVudGx5IGl0IGlzIG5vdCB1c2VkXG4gICAgICB2YXIgY2F0ZWdvcnkgPSAoY3R4LnNlY3Rpb24gPT09IHVuZGVmaW5lZCkgPyAnJyA6IGN0eC5zZWN0aW9uO1xuICAgICAgY2F0ZWdvcnkgKz0gKGN0eC5zdWIgPT09IHVuZGVmaW5lZCB8fCBjdHguc3ViID09PSAnYWxsJykgPyAnJyA6ICcvJyArIGN0eC5zdWI7XG4gICAgICBjYXRlZ29yeSArPSAoY3R4LnN1YnN1YiA9PT0gdW5kZWZpbmVkKSA/ICcnIDogJy8nICsgY3R4LnN1YnN1YjtcbiAgICAgIGNhdGVnb3J5ICs9IChjdHguc3Vic3Vic3ViID09PSB1bmRlZmluZWQpID8gJycgOiAnLycgKyBjdHguc3Vic3Vic3ViO1xuICAgICAgXG4gICAgICAvLyB0aGUgY291bnQgaXMgYXQgbWluaW11bSAxNSBidXQgbXVzdCBiZSBpbiBpbmNyZW1lbnRzIG9mIDE1IGN1cnJlbnRseVxuICAgICAgdmFyIGNvdW50ID0gKGN0eC5jb3VudCA9PT0gdW5kZWZpbmVkKSA/IDE1IDogY3R4LmNvdW50O1xuICAgICAgXG4gICAgICAvLyBtYWtlIHRoZSByZXF1ZXN0IHRvIGdvbGZ3ZWVrIFxuICAgICAgLy8gKioqTVVTVCBCRSBBIFBPU1QgT1IgRUxMSU5HVE9OIEJMT0NLUyBJVCoqKlxuICAgICAgJGh0dHAucG9zdCh1cmwgKyAnc2VjdGlvbi8/U2VjdGlvbj0nICsgY2F0ZWdvcnkgKyAnJk51bT0nICsgY291bnQpXG4gICAgICAgIC5zdWNjZXNzKGZ1bmN0aW9uIChkYXRhKSB7ICBcbiAgICAgICAgICBjdHguc3VjY2VzcyhkYXRhKTtcbiAgICAgICAgfSlcbiAgICAgICAgLmVycm9yKGZ1bmN0aW9uIChkYXRhLCBzdGF0dXMpIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhLCBzdGF0dXMpO1xuICAgICAgICB9KTtcbiAgICB9XG4gIH1cbn1cblxuXG4vLyBBc3NpZ24gZ2V0U3RvcnlMaXN0IGFzIGFuIGFuZ3VsYXIgZmFjdG9yeSBcbi8vIGluIGEgbWFubmVyIHNhZmUgZm9yIG1pbmlmaWNhdGlvblxuaW5mc2NyLmZhY3RvcnkoJ2dldFN0b3J5TGlzdCcsIFsnJGh0dHAnLCBnZXRTdG9yeUxpc3RdKTtcblxuXG5cbi8vIHRoZSBnZXRTdG9yeUNvbnRlbnQgZnVuY3Rpb24gaXMgaW50ZW5kZWQgdG8gbG9hZCB0aGUgY2xpY2tlZFxuLy8gc3RvcnkgaW50byB0aGUgc2VsZWN0ZWQgZGl2XG5mdW5jdGlvbiBnZXRTdG9yeUNvbnRlbnQgKCRodHRwKSB7XG4gIFxuICAvLyB0aGUgYmFzZSB1cmwgdG8gcmVxdWVzdCB0aGUgc3RvcnlkYXRhIGZyb21cbiAgdmFyIHVybCA9ICdodHRwOi8vZ29sZndlZWsuY29tLyc7XG5cbiAgcmV0dXJuIHtcbiAgICBnZXQ6IGZ1bmN0aW9uIChjdHgpIHsgICAgICBcbiAgICAgICRodHRwLnBvc3QodXJsICsgY3R4LnNsdWcgKyAnP2pzb24nKVxuICAgICAgICAuc3VjY2VzcyhmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICAgIGN0eC5zdG9yeVN1Y2Nlc3MoZGF0YSk7XG4gICAgICAgIH0pXG4gICAgICAgIC5lcnJvcihmdW5jdGlvbiAoZGF0YSwgc3RhdHVzKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coZGF0YSwgc3RhdHVzKTtcbiAgICAgICAgfSk7XG4gICAgfVxuICB9XG59XG5cblxuLy8gQXNzaWduIGdldFN0b3J5TGlzdCBhcyBhbiBhbmd1bGFyIGZhY3RvcnkgXG4vLyBpbiBhIG1hbm5lciBzYWZlIGZvciBtaW5pZmljYXRpb25cbmluZnNjci5mYWN0b3J5KCdnZXRTdG9yeUNvbnRlbnQnLCBbJyRodHRwJywgZ2V0U3RvcnlDb250ZW50XSk7XG5cblxuXG4vLyB0aGUgaW5mU2Nyb2xsQ29udHJvbGxlciBmdW5jdGlvbiBpcyBpbnRlbmRlZCB0byBiZSB1c2VkIFxuLy8gaW4gdGhlIGRpdiB3aGVyZSB0aGUgc3RvcmllcyBzaG91bGQgYmUgYWRkZWQgZm9yIGluZmluaXRlIFxuLy8gc2Nyb2xsaW5nXG5mdW5jdGlvbiBpbmZTY3JvbGxDb250cm9sbGVyICgkc2NvcGUsICR3aW5kb3csIHN0b3J5TGlzdCwgc3RvcnkpIHtcblx0JHNjb3BlLmNvdW50ID0gMTU7ICAvLyBudW1iZXIgb2Ygc3RvcmllcyB0byBnZXRcblx0JHNjb3BlLmZldGNoaW5nID0gZmFsc2U7IC8vIGFyZSB3ZSBmZXRjaGluZyByaWdodCBub3c/XG4gICRzY29wZS5zdG9yaWVzID0gW107IC8vIHN0YXJ0cyBvdXQgYXMgYW4gZW1wdHkgYXJyYXlcblxuICAkc2NvcGUuJG9uKCdMT0FEJywgZnVuY3Rpb24gKGUpIHsgJHNjb3BlLmZldGNoaW5nID0gdHJ1ZTsgfSk7XG4gICRzY29wZS4kb24oJ0xPQURET05FJywgZnVuY3Rpb24gKGUpIHsgJHNjb3BlLmZldGNoaW5nID0gZmFsc2U7IH0pO1xuXG4gIC8vIHRoaXMgaXMgdGhlIHN1Y2Nlc3MgaGFuZGxlciB3aGVuIGRhdGEgaXMgcmVjZWl2ZWRcbiAgJHNjb3BlLnN1Y2Nlc3MgPSBmdW5jdGlvbiAoZGF0YSkge1xuICAgIGFuZ3VsYXIuZm9yRWFjaChkYXRhLnN0b3JpZXMsIGZ1bmN0aW9uICh2YWwsIGtleSkge1xuICAgICAgdGhpc1trZXldID0gdmFsO1xuICAgIH0sICRzY29wZS5zdG9yaWVzKTtcbiAgICAvLyBjb25zb2xlLmxvZygnJU8nLCAkc2NvcGUuc3Rvcmllc1swXSk7XG4gICAgLy8gbGV0IGV2ZXJ5dGhpbmcga25vdyB3ZSBhcmUgZG9uZSBsb2FkaW5nXG4gICAgJHNjb3BlLiRlbWl0KCdMT0FERE9ORScpO1xuICB9XG5cbiAgLy8gZ2V0IHRoZSBzdG9yaWVzIHRoZSBmaXJzdCB0aW1lXG4gIHN0b3J5TGlzdC5nZXQoJHNjb3BlKTtcblxuICAvLyBnZXRNb3JlIHNob3VsZCBiZSB1c2VkIHdoZW4gdGhlIGRpdiBpcyBzY3JvbGxlZFxuXHQkc2NvcGUuZ2V0TW9yZSA9IGZ1bmN0aW9uICgpIHtcblx0XHQvLyBpZiBwYWdlIHBvc2l0aW9uIGlzIGJpZ2dlciB0aGFuIDg4IFxuXHRcdC8vIGZldGNoIG1vcmUgc3Rvcmllc1xuXHRcdGlmICghJHNjb3BlLmZldGNoaW5nKSB7XG4gICAgICAkc2NvcGUuJGVtaXQoJ0xPQUQnKTtcbiAgICAgICRzY29wZS5jb3VudCA9ICgkc2NvcGUuY291bnQgPT09IDYwKSA/IDYwIDogJHNjb3BlLmNvdW50ICsgMTU7XG5cdFx0XHQvLyBsZXQgZXZlcnl0aGluZyBrbm93IHdlIGFyZSBsb2FkaW5nXG4gICAgICBzdG9yeUxpc3QuZ2V0KCRzY29wZSk7XG5cblx0XHR9XG5cdH1cblxuICAkc2NvcGUuc3RvcnlTdWNjZXNzID0gZnVuY3Rpb24gKGRhdGEpIHtcbiAgICAvLyBzZXQgdGhlIGRhdGEgaGVyZSB0byB0aGUgZXhwYW5kaW5nIGRpdiBmb3IgdGhlIHN0b3J5XG4gICAgLy8gY29uc29sZS5sb2coJyVvJywgJHNjb3BlLnN0b3JpZXMpO1xuICAgICRzY29wZS5zdG9yaWVzWyRzY29wZS5zdG9yeUlkXVsnc3RvcnlDb250ZW50J10gPSBkYXRhLnN0b3J5WzBdO1xuICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICB9XG5cblxuICAkc2NvcGUuc3RvcnlDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICAvLyBjb25zb2xlLmxvZygnJW8nLHRoaXMuJGluZGV4KVxuICAgICRzY29wZS5zbHVnID0gdGhpcy5zdG9yeS5pZDtcbiAgICAkc2NvcGUuc3RvcnlJZCA9IHRoaXMuJGluZGV4O1xuICAgIHN0b3J5LmdldCgkc2NvcGUpO1xuICB9XG5cblxufVxuXG5cbi8vIEFzc2lnbiBpbmZTY3JvbGxDb250cm9sbGVyIGFzIGFuIGFuZ3VsYXIgY29udHJvbGxlciBcbi8vIGluIGEgbWFubmVyIHNhZmUgZm9yIG1pbmlmaWNhdGlvblxuaW5mc2NyLmNvbnRyb2xsZXIoJ2luZlNjcm9sbEN0cmwnLCBbJyRzY29wZScsICckd2luZG93JywgJ2dldFN0b3J5TGlzdCcsICdnZXRTdG9yeUNvbnRlbnQnLCBpbmZTY3JvbGxDb250cm9sbGVyXSk7XG5cblxuXG5cblxuXG4oZnVuY3Rpb24gKCkge1xuXG4gIHZhciBUSEVDT0RFID0gWzM4LDM4LDQwLDQwLDM3LDM5LDM3LDM5LDY2LDY1XTtcblxuICB2YXIgdGVzdGNvZGUgPSBbXTtcbiAgdmFyIHRpbWU7XG5cbiAgLy8gayBjb2RlIHN0dWZmXG4gIGZ1bmN0aW9uIGNoZWNrS2V5cyAoZSkge1xuICAgIHZhciBidXR0b24gPSAoZS5rZXlDb2RlKTtcblxuICAgIGlmIChUSEVDT0RFLmluZGV4T2YoYnV0dG9uKSA+IC0xKSB7XG4gICAgICB0ZXN0Y29kZVt0ZXN0Y29kZS5sZW5ndGhdID0gZS5rZXlDb2RlO1xuXG4gICAgICBpZiAodGVzdGNvZGUubGVuZ3RoID09PSBUSEVDT0RFLmxlbmd0aCkge1xuICAgICAgICBjaGVja0NvZGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNsZWFyQ29kZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGNoZWNrQ29kZSAoKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBUSEVDT0RFLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAoVEhFQ09ERVtpXSAhPT0gdGVzdGNvZGVbaV0pIHtcbiAgICAgICAgdGVzdGNvZGUgPSBbXTtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0ZXN0Y29kZS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zb2xlLmxvZygnZHVmIHRpbWUhJyk7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gY2xlYXJDb2RlICgpIHtcbiAgICBpZiAodGltZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aW1lID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHRlc3Rjb2RlID0gW107XG4gICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQodGltZSk7XG4gICAgICB9LCAxMDAwMCk7XG4gICAgfVxuICB9XG5cblxuICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGNoZWNrS2V5cyk7XG59KSgpXG5cblxufSkoYW5ndWxhcik7IiwiKGZ1bmN0aW9uIChhbmd1bGFyLCAkKSB7XG5cdFxuXHQvLyB0aGlzIGlzIHRoZSBsaXZlIHNjb3JpbmcgYXBwIGZvciB0aGUgd2lkZ2V0IG9uIHRoZSB0b3AgcmlnaHRcblx0Ly8gbGl2ZSBzY29yaW5nIHdpbGwgbWF0Y2ggYXMgY2xvc2VseSBhcyBwb3NzaWJsZSB0aGUgb3V0cHV0IGZyb20gdGhlXG5cdC8vIGVsZW1lbnQgd2l0aCB0aGUgaWQgXCJmcmFtaW5nXCJcblx0Ly8gZGlmZmVyZW50IGJlaGF2aW91ciB3aWxsIGxpa2VseSBuZWVkIHRvIGJlIHB1dCBpbiBwbGFjZSBmb3IgdGhlIFxuXHQvLyBob21lIHBhZ2UgdmVyc2lvblxuXHQvLyAqKipOT1RFIG53aWQgKG5hdGlvbndpZGUpIGlzIG5vdyBrbm93biBhcyB3ZWIuY29tIHRvdXIgKioqXG5cdC8vIHBnYSAvIG53aWQgLyBjaG1wIHNjb3Jpbmcgd2lsbCBjb21lIGZyb20geG1sIGRvY3VtZW50cyBvbiByYW5raW5ncy5nb2xmd2Vlay5jb21cblx0Ly8gY29sbGVnZSAvIGFtYXRldXIgLyBqdW5pb3Igc2NvcmluZyB3aWxsIGNvbWUgZnJvbSBnb2xmc3RhdFxuXG5cblx0Ly8gUEdBIG1vZGVsXG5cblx0Ly8gcGdhIGRhdGEgc2hvdWxkIGJlIHRoZSB4bWwgZGF0YSBcblx0ZnVuY3Rpb24gUEdBIChwZ2FkYXRhKSB7XG5cdFx0aWYgKHBnYWRhdGEpIHtcblx0XHRcdHRoaXMuc2V0RGF0YShwZ2FkYXRhKTtcblx0XHR9XG5cdFx0Ly8gb3RoZXIgc3RhbmRhcmQgaW5pdGlhbGl6YXRpb25zXG5cdH1cblxuXHRQR0EucHJvdG90eXBlID0ge1xuXHRcdHNldERhdGE6IGZ1bmN0aW9uIChwZ2FkYXRhKSB7XG5cdFx0XHRhbmd1bGFyLmV4dGVuZCh0aGlzLCBwZ2FkYXRhKTtcblx0XHR9LFxuXHRcdC8vIExvYWQgd2lsbCBmZXRjaCB0aGUgZGF0YSBmcm9tIHRoZSBwZ2EgeG1sXG5cdFx0bG9hZDogZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIHNjb3BlID0gdGhpcztcblx0XHRcdHNjb3BlLnBsYXllcnMgPSBbXTtcblx0XHRcdCQuYWpheCh7XG5cdFx0XHRcdHR5cGU6IFwiR0VUXCIsXG5cdFx0XHRcdHVybDonaHR0cDovL3JhbmtpbmdzLmdvbGZ3ZWVrLmNvbS9mZXRjaHVybC9hc3NldHMvcGdhLnhtbCcsXG5cdFx0XHRcdGRhdGFUeXBlOiAneG1sJ1xuXHRcdFx0XHR9KS5zdWNjZXNzKGZ1bmN0aW9uIChwZ2FkYXRhKSB7XG5cdFx0XHRcdHNjb3BlLnNldERhdGEocGdhZGF0YSk7XG5cdFx0XHRcdHZhciBwbGF5ZXJzID0gJChwZ2FkYXRhKS5maW5kKCdQbGF5ZXInKTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IHBsYXllcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdFx0XHRwbGF5ZXIgPSB7fTtcblx0XHRcdFx0XHRwbGF5ZXIubmFtZSA9ICQocGxheWVyc1tpXSkuYXR0cignRkluaXQnKSArIFwiLiBcIiArICQocGxheWVyc1tpXSkuYXR0cignTG5hbWUnKTtcblx0XHRcdFx0XHRwbGF5ZXIuY3VycmVudF9yYW5rID0gJChwbGF5ZXJzW2ldKS5hdHRyKCdDdXJQb3MnKTtcblx0XHRcdFx0XHRwbGF5ZXIudG9kYXkgPSAkKHBsYXllcnNbaV0pLmF0dHIoJ0N1clBhclJlbCcpO1xuXHRcdFx0XHRcdHBsYXllci5vdmVyYWxsID0gJChwbGF5ZXJzW2ldKS5hdHRyKCdUb3VyblBhclJlbCcpO1xuXHRcdFx0XHRcdHBsYXllci50aHJ1ID0gJChwbGF5ZXJzW2ldKS5hdHRyKCdUaHJ1Jyk7XHRcdFx0XG5cdFx0XHRcdFx0c2NvcGUucGxheWVycy5wdXNoKHBsYXllcik7XG5cdFx0XHRcdH07XG5cdFx0XHR9KTtcblx0XHR9XG5cdH1cblxuXHRcblx0dmFyIHRoZWQgPSBuZXcgUEdBKCk7XG5cdHRoZWQubG9hZCgpO1xuXHRjb25zb2xlLmxvZyh0aGVkKTtcblxufSkoYW5ndWxhciwgalF1ZXJ5KTsiXX0=
